<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>RTP Live – Dashboard</title>
<style>
  :root{
    --bg:#13132a; --card:#1c1c3f; --muted:#8d90b3; --hi:#20c997; --mid:#ffc107; --low:#f03e3e;
    --accent:#6c5ce7;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial;
    background:linear-gradient(180deg,#0f1030 0%, #13132a 100%);
    color:#fff;
  }
  header{
    position:sticky; top:0; z-index:10; backdrop-filter: blur(6px);
    background:rgba(19,19,42,.75); border-bottom:1px solid rgba(255,255,255,.06);
  }
  .wrap{max-width:1200px; margin:0 auto; padding:14px 16px;}
  h1{margin:0 0 8px;font-size:20px; font-weight:700; letter-spacing:.2px}
  .toolbar{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
  .toolbar .group{display:flex; gap:8px; align-items:center}
  input[type="search"], select{
    background:#0f1030; border:1px solid rgba(255,255,255,.12); color:#fff;
    padding:10px 12px; border-radius:10px; outline:none; min-width:220px;
  }
  .btn{
    background:var(--accent); border:none; color:#fff; padding:10px 14px; border-radius:12px;
    cursor:pointer; font-weight:600; box-shadow:0 6px 16px rgba(108,92,231,.35);
  }
  .btn:disabled{opacity:.6; cursor:not-allowed; box-shadow:none}
  .meta{margin-left:auto; color:var(--muted); font-size:12px}
  .grid{
    max-width:1200px; margin:14px auto; padding:8px 16px 32px;
    display:grid; gap:16px;
    grid-template-columns:repeat(auto-fill, minmax(160px,1fr));
  }
  .card{
    position:relative; background:var(--card); border:1px solid rgba(255,255,255,.06);
    border-radius:16px; overflow:hidden; box-shadow:0 6px 20px rgba(0,0,0,.25);
    padding:10px;
    transition:transform .15s ease, box-shadow .15s ease;
  }
  .card:hover{transform:translateY(-2px); box-shadow:0 10px 28px rgba(0,0,0,.35)}
  .thumb{width:100%; aspect-ratio:1/1; object-fit:cover; display:block; border-radius:12px;}
  .title{
    font-size:14px; font-weight:700; margin:8px 0 4px; color:#e8e9ff;
  }
  .provider{
    font-size:12px; color:var(--muted); margin-bottom:6px;
  }
  .bar {
    position:relative;
    height:16px;
    background:rgba(255,255,255,.08);
    border-radius:6px;
    overflow:hidden;
  }
  .bar .fill { height:100%; }
  .bar .label {
    position:absolute;
    width:100%;
    text-align:center;
    font-size:12px;
    font-weight:700;
    color:#fff;
    text-shadow:0 0 3px rgba(0,0,0,.8);
  }
  .status{
    text-align:center; color:var(--muted); padding:40px 16px; font-size:14px;
  }
  .hide{display:none}
  .legend{display:flex; gap:8px; align-items:center; font-size:12px; color:var(--muted)}
  .dot{width:10px; height:10px; border-radius:50%}
  .dot.hi{background:var(--hi)} .dot.mid{background:var(--mid)} .dot.low{background:var(--low)}
</style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>RTP Live – Dashboard</h1>
      <div class="toolbar">
        <div class="group">
          <input id="search" type="search" placeholder="Cari game…" />
          <select id="range">
            <option value="all">Semua RTP</option>
            <option value="61-98">61–98%</option>
            <option value="41-60">41–60%</option>
            <option value="20-40">21–40%</option>
          </select>
          <select id="provider">
            <option value="all">Semua Provider</option>
          </select>
        </div>

        <div class="legend">
          <span class="dot hi"></span> Tinggi
          <span class="dot mid" style="margin-left:8px"></span> Sedang
          <span class="dot low" style="margin-left:8px"></span> Rendah
        </div>

        <div class="meta" id="meta">Last updated: –</div>
        <button class="btn" id="refresh">Refresh</button>
      </div>
    </div>
  </header>

  <div id="status" class="status">Memuat data…</div>
  <div id="grid" class="grid hide"></div>

<script>
  const REFRESH_MS = 12 * 60 * 60 * 1000; // 12 jam
  const $grid   = document.getElementById('grid');
  const $status = document.getElementById('status');
  const $meta   = document.getElementById('meta');
  const $search = document.getElementById('search');
  const $range  = document.getElementById('range');
  const $prov   = document.getElementById('provider');
  const $btn    = document.getElementById('refresh');
  let DATA = [];

  const fmtTime = d => new Intl.DateTimeFormat('id-ID',{
    hour:'2-digit',minute:'2-digit',second:'2-digit',day:'2-digit',month:'short'
  }).format(d);

  function mockFetch(){
    const items = [
      { nama: 'Sweet Bonanza',      gambar: 'Gambar RTP/Sweet Bonanza.png',      rtp: 86, provider: 'Pragmatic' },
      { nama: 'Gates of Olympus',   gambar: 'Gambar RTP/Gates Of Olympus.png',   rtp: 65, provider: 'Pragmatic' },
      { nama: 'Starlight Princess', gambar: 'Gambar RTP/Starlight Princess.png', rtp: 90, provider: 'Pragmatic' },
      { nama: 'Sugar Rush 1000',    gambar: 'Gambar RTP/Sugar Rush 1000.png',    rtp: 78, provider: 'Pragmatic' },
      { nama: 'Aztec Gems',         gambar: 'Gambar RTP/Aztec Gems.png',         rtp: 80, provider: 'Pragmatic' },
      { nama: 'Wild West Gold',     gambar: 'Gambar RTP/Wild West Gold.png',     rtp: 55, provider: 'Pragmatic' },
      { nama: 'Lucky’s Wild Pub',   gambar: 'Gambar RTP/Lucky’s Wild Pub.png',   rtp: 76, provider: 'Pragmatic' },
      { nama: 'Fiesta Fortune',     gambar: 'Gambar RTP/Fiesta Fortune.png',     rtp: 43, provider: 'Pragmatic' },
      { nama: 'Tiny Toads',         gambar: 'Gambar RTP/Tiny Toads.png',         rtp: 57, provider: 'Pragmatic' },
      { nama: 'Infini88 Gates Of Gatot Kaca', gambar: 'Gambar RTP/Infini88 Gates Of Gatot Kaca.png', rtp: 97, provider: 'Pragmatic' },
      { nama: 'Gates Of Olympus Xmas 1000', gambar: 'Gambar RTP/Gates Of Olympus Xmas 1000.png', rtp: 95, provider: 'Pragmatic' },
      { nama: 'Greedy Fortune Pig', gambar: 'Gambar RTP/Greedy Fortune Pig.png', rtp: 83, provider: 'Pragmatic' },
      { nama: 'Gates of Hades',     gambar: 'Gambar RTP/Gates Of hades.png',     rtp: 69, provider: 'Pragmatic' },
      { nama: 'Mahjong Ways',       gambar: 'Gambar RTP/Mahjong Ways.png',       rtp: 93, provider: 'Pocket Game Soft' },
    ];
    return new Promise(res=>setTimeout(()=>res({ok:true,json:()=>Promise.resolve(items)}), 600));
  }

  async function fetchRTP(){
    $btn.disabled = true;
    $status.classList.remove('hide');
    $grid.classList.add('hide');
    $status.textContent = 'Memuat data…';

    try{
      const resp = await mockFetch();
      if(!resp.ok) throw new Error('HTTP ' + resp.status);
      DATA = await resp.json();
      const provs = Array.from(new Set(DATA.map(d=>d.provider || 'Lainnya')));
      $prov.innerHTML = `<option value="all">Semua Provider</option>` +
                        provs.map(p=>`<option value="${p}">${p}</option>`).join('');
      render();
      $meta.textContent = 'Last updated: ' + fmtTime(new Date());
      $status.classList.add('hide');
      $grid.classList.remove('hide');
    }catch(e){
      console.error(e);
      $status.textContent = 'Gagal memuat data. Coba lagi.';
    }finally{
      $btn.disabled = false;
    }
  }

  function render(){
  const q = ($search.value || '').toLowerCase();
  const range = $range.value;
  const prov  = $prov.value;
  const [min,max] = range==='all' ? [0,100] : range.split('-').map(Number);

  const items = DATA.filter(d=>{
    const okName = d.nama.toLowerCase().includes(q);
    const okRange = d.rtp>=min && d.rtp<=max;
    const okProv = prov==='all' || (d.provider||'Lainnya')===prov;
    return okName && okRange && okProv;
  });

  if(!items.length){
    $grid.innerHTML = '';
    $status.classList.remove('hide');
    $status.textContent = 'Tidak ada hasil yang cocok.';
    return;
  }else{
    $status.classList.add('hide');
  }

  $grid.innerHTML = items.map(d=>{
    let color;
    if (d.rtp >= 61) {
      color = 'var(--hi)';      // hijau
    } else if (d.rtp >= 41) {
      color = 'var(--mid)';     // kuning
    } else {
      color = 'var(--low)';     // merah
    }

    return `
      <article class="card">
        <img class="thumb" src="${d.gambar}" alt="${d.nama}" 
             onerror="this.onerror=null;this.src='Gambar RTP/default.png'">
        <div class="title">${d.nama}</div>
        <div class="provider">${d.provider || 'Provider'}</div>
        <div class="bar">
          <span class="fill" style="width:${d.rtp}%;background:${color};"></span>
          <span class="label">${d.rtp}%</span>
        </div>
      </article>
    `;
  }).join('');
}
  
  [$search,$range,$prov].forEach(el=>el.addEventListener('input', render));
  $btn.addEventListener('click', fetchRTP);
  fetchRTP();
  setInterval(fetchRTP, REFRESH_MS);
</script>
</body>
</html>
